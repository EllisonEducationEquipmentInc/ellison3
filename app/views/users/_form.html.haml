- if is_ee?
  .field
    = f.label :institution
    %br/
    = f.select :institution, institutions
- if is_er? || is_ee?
  .field
    = f.label :company, "<span class='required'>#{is_sizzix_us? ? 'Attention:' : is_ee? ? 'School/Institution Name' : is_er? ? 'Company Name' : 'Company/School/Organization'}</span>".html_safe, :class => "autosize"
    %br/
    = f.text_field :company
.field
  = f.label :name, is_sizzix? ? "Name" : "Contact Person"
  %br/
  = f.text_field :name
.field
  = required_label f, :email
  %br/
  = f.text_field :email, :class => 'email'
.field
  = required_label f, :password
  %br/
  = f.password_field :password, :class => 'password', :onkeyup => "$(this).valid()"
  .password-meter
    .password-meter-bg.left
      .password-meter-bar
    .password-meter-message.left
  .clear
  %p.formhelp
    == Password must be between #{"<strong>8-15 characters</strong>".html_safe}
    %br
    == with at least #{"<strong>one letter</strong>".html_safe} and #{"<strong>one number</strong>".html_safe} chosen
.field
  = required_label f, :password_confirmation, { :label => "Password Confirmation", :label_size => "auto" }
  %br/
  = f.password_field :password_confirmation, :class => 'password_confirm'
.action= f.submit "Sign up", :class => 'jqui_save'
:javascript
  $(document).ready(function() { 
    // validate signup form on keyup and submit 
    var validator = $("#user_new").validate({
      errorClass: "invalid",
      rules: { 
        "user[password]": {
          required: true,
          password: "#user_email",
          minlength: 8
        },
        "user[password_confirmation]": {
          required: true,
          minlength: 8,
          equalTo: "#user_password"
        },
        "user[email]": {
          required: true,
          email: true
        },
        "user[company]": {
          required: #{is_er? || is_ee? ? 'true' : 'false'}
        }
      },
      messages: {
        "user[password]": {
          required: "Please provide a password",
          rangelength: jQuery.format("Enter at least {0} characters")
        },
        "user[password_confirmation]": {
          required: "Please confirm your password",
          minlength: jQuery.format("Enter at least {0} characters"),
          equalTo: "Enter the same password as above"
        },
        "user[email]": {
          required: "Please enter a valid email address",
          minlength: "Please enter a valid email address",
          remote: jQuery.format("{0} is already in use")
        },
        "user[company]": {
          required: "Please enter #{is_er? ? 'company' : is_ee? ? 'school/institution' : 'company/school/organization'} name"
        }
      },

      // set this class to error-labels to indicate valid fields 
      success: function(label) {
        // set as text for IE
        label.html(" ").addClass("checked");
      }
    });
  });
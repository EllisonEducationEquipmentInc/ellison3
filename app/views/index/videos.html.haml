%h2== #{system_name.capitalize} Videos
.contentwrap_medium
  %h3 Featured Video

.contentwrap_XL.last
  %h3 Our Most Recent Uploads
  
  %h3== Search #{system_name.capitalize} Videos
  = text_field_tag :video_keyword, nil, :autocomplete => "off", :value => "enter keywords", :onfocus => "if (this.value == 'enter keywords'){this.value='';}", :onblur => "if (this.value == ''){this.value='enter keywords';}", :size => 50
  :javascript
    $("#video_keyword").addClass("idlefield");
    $("#video_keyword").focus(function(){
      $(this).addClass("activefield").removeClass("idlefield");
    }).blur(function(){
      $(this).removeClass("activefield").addClass("idlefield");
    });

  %span.jqui_search Search

.contentwrap_XXXL.last
  .tab-block
    %ul
      - if @recent_uploads.present?
        %li= link_to "Recent Uploads", "#recent_uploads"
      - @videos.each do |playlist|
        %li= link_to playlist.title, "##{playlist.title.parameterize}"
      %li= link_to "Search Videos", "#search_videos"
    - if @recent_uploads.present?
      #recent_uploads
        %h3 Recent Uploads
        %ul.videolist= render :partial => 'video', :collection => @recent_uploads
    - @videos.each do |playlist|
      %div{:id => playlist.title.parameterize}
        %h3= playlist.title
        %ul.videolist= render :partial => 'video', :collection => playlist.videos
    #search_videos
      %h3 Search Videos
      .highlightable
        %ul.videolist#video_search
  :javascript
    $('.video-thumbnail').CreateBubblePopup({
      position: 'top',
      align: 'center',
      distance: '50px',
      tail: {
        align: 'middle',
        hidden: false
      },
      selectable: true,
      innerHtml: '<div class="tip_play-video">click this thumbnail<br />to play the video</div>',
      innerHtmlStyle: {
        color: '#333333',
        'text-align': 'center'
      },
      themeName: 'azure',
      themePath: '/images/ui-plugins/bubblepopup'
    });
      
  :javascript
    $('#video_keyword').change(function() {
      if (this.value.length < 3) {
        return false;
      } else {
        $('.tab-block').tabs("select", $('.tab-block').tabs("length") - 1);
        location.hash = $.param.fragment( location.hash, {q: this.value}, 0 );
        $.ajax({url:'/index/search_videos?q='+this.value, success: function(data){
          $('#video_search').html(data);
          highlight_keyword();
          $('#video_keyword').val('');
          youtube_video_links();
        }});
      }
    });
    youtube_video_links();
  - if params[:v].present?
    :javascript
      $(document).ready(function(){$('##{params[:v]}').trigger('click')});
.breadcrumbs.dontprint
  = link_to_function 'back', "window.history.back()", :class => "link_back"
.item_images
  #large_image= image_tag(@product.large_image)
  .dontprint
    .thumbnail.selected= link_to image_tag(@product.small_image), '#', :onmouseover => "$('#large_image').html('#{image_tag(@product.large_image)}'); return false;"
    - @product.images.each do |image|
      - next unless image.image?
      .thumbnail= link_to image_tag(image.image_url(:small)), '#', :onmouseover => "$('#large_image').html('#{image_tag(image.image_url(:large))}'); return false;"
    .clear  
%h3.item_title
  = @product.name.html_safe
  %span.life-cycle= @product.public_life_cycle
.item_description
  = @product.description.try :html_safe
.item_sociallinks.dontprint= facebook_like
.buybox.rounded
  %h4.itemnumber== Item ##{@product.item_num}
  %h4= display_product_price(@product)
  .dontprint
    = add_to_cart_button(@product, 'add_to_cart detail')
.item_compatibility
  %h4 Compatibility
  %p This die is compatible with these machines:
  %ul.plain
    %li
      = link_to "#" do
        %span.compatibility-plus.tooltip_bigshot Compatibility Plus
        = image_tag("/images/ui-objects/machines/BigShot.jpg", :class => "thumbnail")
    %li
      = link_to "#" do
        %span.compatibility-plus.tooltip_vagabond Compatibility Plus
        = image_tag("/images/ui-objects/machines/Vagabond.jpg", :class => "thumbnail")
    %li
      = link_to "#" do
        %span.compatibility-plus.tooltip_bigshotpro Compatibility Plus
        = image_tag("/images/ui-objects/machines/BigShotPro.jpg", :class => "thumbnail")
    
    :javascript
      $('.tooltip_bigshot').CreateBubblePopup({
        position: 'top',
        align: 'center',
        tail: {
          align: 'middle',
          hidden: false
        },
        selectable: true,
        innerHtml: '<strong>#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Big Shot Machine</strong><br />#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Accessory - Premium Crease Pad, Extended<br />#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Accessory - Cutting Pad, Extended, 1 Pair',
        innerHtmlStyle: {
          color: '#333333',
          'text-align': 'left'
        },
        themeName: 'azure',
        themePath: '/images/ui-plugins/bubblepopup'
      });
      $('.tooltip_vagabond').CreateBubblePopup({
        position: 'top',
        align: 'center',
        tail: {
          align: 'middle',
          hidden: false
        },
        selectable: true,
        innerHtml: '<strong>#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Vagabond Machine - inspired by Tim Holtz&reg;</strong><br />#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Accessory - Premium Crease Pad, Extended<br />#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Accessory - Cutting Pad, Extended, 1 Pair',
        innerHtmlStyle: {
          color: '#333333',
          'text-align': 'left'
        },
        themeName: 'azure',
        themePath: '/images/ui-plugins/bubblepopup'
      });
      $('.tooltip_bigshotpro').CreateBubblePopup({
        position: 'top',
        align: 'center',
        tail: {
          align: 'middle',
          hidden: false
        },
        selectable: true,
        innerHtml: '<strong>#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Big Shot Pro Machine</strong><br />#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Accessory - Premium Crease Pad, Extended<br />#{link_to image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/shopping-basket--plus.png"), "#"} Sizzix Accessory - Cutting Pad, Extended, 1 Pair',
        innerHtmlStyle: {
          color: '#333333',
          'text-align': 'left'
        },
        themeName: 'azure',
        themePath: '/images/ui-plugins/bubblepopup'
      });

  .clear
  %p== What does #{image_tag("/images/ui-icons/set_fugue/16x16/drop-shadow/plus-octagon-frame.png", :alt => "Compatibility Plus", :title => "Compatibility Plus", :class => "tooltip_plusinfo")} mean?
  :javascript
    $('.tooltip_plusinfo').CreateBubblePopup({
      position: 'top',
      align: 'center',
      tail: {
        align: 'middle',
        hidden: false
      },
      selectable: true,
      innerHtml: '<div style="width:175px;">Machines with this symbol require a few additional accessories before they can be used with this die.</div>',
      innerHtmlStyle: {
        color: '#333333',
        'text-align': 'center'
      },
      themeName: 'azure',
      themePath: '/images/ui-plugins/bubblepopup'
    });

%div{ :class => "item_detail#{'-tabbed' if @product.use_tabs}"}
  = render :partial => "#{'non_' unless @product.use_tabs}tab_block", :locals => {:object => @product}
- unless @product.use_tabs
  .item_cross-sell.rounded
    - unless @product.ideas.blank?
      %h4 Related Ideas:
      .related_ideas= render :partial => 'ideas/related_idea', :collection => @product.ideas, :as => :idea
    - unless @product.four_related_products.blank?
      %h4
        Related Products
        = link_to "View All", catalog_path(:anchor => "facets=#{@product.related_tag.facet_param}&page=1#{'&outlet=1' if @product.outlet}"), :class => "minilink"
      .related_products= render :partial => 'products/related_product', :collection => @product.four_related_products, :as => :product
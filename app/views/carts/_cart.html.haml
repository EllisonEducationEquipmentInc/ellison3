- if @cart.cart_items.blank?
  %h2== Your Shopping #{cart_name} is empty.
  - if user_signed_in? && get_user.save_for_later_list.products.count > 0
    %p
      You saved the item(s) below to buy later.
      %br
      If you'd like to buy one or more now, just click the Move to Cart button next to the item(s) you're ready to buy.
- else
  %h2
    You have
    %span#cart_items_qty_header= pluralize get_cart.total_quantity, "item"
    == in your shopping #{cart_name}
  %table{:cellpadding => 10}
    %thead
      %tr
        %th{:width => 60} Item No.
        %th{:width => 70} Item Name
        %th.dontprint{:width => 400}
        - if admin_signed_in? && current_admin.can_change_prices
          %th Upsell
        %th{:style => "text-align: right; white-space: nowrap;"}== #{is_er? ? 'Wholesale' : 'Retail'} Price
        %th{:style => "text-align: right", :width => 75} You Pay
        %th{:style => "text-align: right", :width => 70} Quantity
        %th{:style => "text-align: right", :width => 75} Total Price
        %th.dontprint{:style => "text-align: right;" }
    %tbody
      = render :partial => 'carts/cart_item', :collection => @cart.cart_items
      %tr
        %td
        %td
        %td
        - if admin_signed_in? && current_admin.can_change_prices
          %td
        %td.dontprint#total_savings{ :colspan => 2}= render :partial => 'carts/total_savings'
        %td{:style => "text-align: right", :class => "cart_extended_price"} Subtotal:
        %td#cart_subtotal{:style => "text-align: right", :class => "cart_extended_price"}= number_to_currency gross_price(@cart.sub_total)
        %td.dontprint{:style => "text-align: right;" }
    - unless @cart_locked
      :javascript
        $('input.number_only').keydown(number_only)
        .keyup(function(){
          if ($(this).val().length < 1) {
            var original_value = $(this).attr('defaultValue');
            $(this).val(original_value);
          }
          var item_num = this.id.replace('cart_quantity_', '')
          $.ajax({url:"/carts/change_quantity?item_num="+item_num+"&qty="+$(this).val()});
          _gaq.push(['_trackEvent', 'Cart', 'Change Quantity', item_num+':'+$(this).val()]);
        })
    - if admin_signed_in? && current_admin.can_change_prices && !@cart_locked
      :javascript
        $(".cart_item_price").editInPlace({
          url: "/carts/custom_price",
          value_required: true,
          show_buttons: true,
          saving_animation_color: "#ECF2F8"
        });
  :javascript 
    $("table").each(function() {
      $(this).addClass("ui-widget ui-widget-content ui-corner-all");
    });
    $("table thead").each(function() {
      $(this).addClass("ui-state-hover");
    });

  .dontprint
    - unless @cart_locked
      #cart_coupon= render :partial => "carts/coupon"
      - if quote_allowed?
        .save_as_quote.right Save as Quote
      - if chekout_allowed? && quote_allowed?
        .right{ :style => "margin: 4px 10px 0 10px; font-weight: bold; text-transform: uppercase" } or
      - if chekout_allowed?
        #checkout_button.right= "Checkout"
      - elsif get_cart.pre_order?
        .save_as_quote.right Pre-Order
      .clear
      - if get_cart.pre_order?
        %p.error There are items in the cart that are available for pre-order only. If you would like to place a pre-order please click "Pre-Order". For immediate shipping please remove these items.
      - elsif backorder_allowed? && get_cart.out_of_stock? && !is_ee_uk?
        %p.error Due to high demand, some items in your cart are currently at a low stock level. If your order cannot be processed within normal ordering time, we will contact you as soon as possible.
      :javascript
        $(document).ready(function(){
          if ($("#fancybox-wrap:visible").length > 0) $('.save_for_later').hide();
        });
        $(function() {
          $("#checkout_button").button()
            .click( function() {
              $.ajax({url:"#{checkout_requested_path}", complete: function(){$.fancybox.resize()}});
              $(this).button({disabled: true, label: 'please wait...'});
        		});
        	$(".remove_from_cart").click( function() {
        			$.ajax({url:"/carts/remove_from_cart?item_num="+this.id.replace('remove_from_cart_', '')});
        			_gaq.push(['_trackEvent', 'Cart', 'Remove From Cart', this.id.replace('remove_from_cart_', '')]);
        			$(this).html('#{escape_javascript loader_bar}')
        		}); 
        		$(".save_for_later").click( function() {
        				$.ajax({url:"/users/save_for_later?item_num="+$(this).attr('rel')});
        				_gaq.push(['_trackEvent', 'Cart', 'Save for Later', $(this).attr('rel')]);
        				$(this).html('#{escape_javascript loader_bar}')
        			});
        		$(".save_as_quote")
          	  .button({icons: {primary: 'ui-icon-clipboard'}})
          		.click( function() {
                $.ajax({url:"#{quote_requested_path}", complete: function(){$.fancybox.resize()}});
                $(this).button({disabled: true, label: 'please wait...'});
          		});
        });
      .cart_disclaimer
        - if is_sizzix_us?
          %p Updates to stock status on Sizzix.com are done routinely. Product availability shown on the Web site is not guaranteed (especially on clearance and promotional items) until your order is processed by Ellison and your credit card is charged. Orders are processed on a first come, first served basis with every attempt made by Sizzix Consumer Service to fulfill your order to your satisfaction. Email updates will be sent as we process your items.
          %p== Sizzix.com cannot accept online orders from consumers requiring delivery outside of the United States (except APO/FPOs). #{link_to "International Support", "/intl"}.
        - if is_sizzix_uk?
          %p Updates to stock status on Sizzix.co.uk are done routinely. Product availability shown on the Web site is not guaranteed (especially on clearance and promotional items) until your order is processed by Ellison and your credit card is charged. Orders are processed on a first come, first served basis with every attempt made by Sizzix.co.uk Consumer Service to fulfill your order to your satisfaction. Email updates will be sent as we process your items.
          %p== For all deliveries outside of Europe, please #{link_to "contact us", "/contact"}.
        - if is_ee_us?
          %p Updates to stock status on ellisoneducation.com are done routinely. Product availability shown on the Web site is not guaranteed (especially on clearance and promotional items) until your order is processed by Ellison and your credit card is charged. Orders are processed on a first come, first served basis with every attempt made by Ellison Customer Service to fulfill your order to your satisfaction. Email updates will be sent as we process your items.
          %p== Ellisoneducation.com cannot accept online orders from consumers requiring delivery outside of the United States (except APO/FPOs). International Support. #{link_to "International Support", "/intl"}.
        - if is_ee_uk?
          %p Updates to stock status on ellisoneducation.co.uk are done routinely. Product availability shown on the Web site is not guaranteed (especially on clearance and promotional items) until your order is processed by Ellison and your credit card is charged. Orders are processed on a first come, first served basis with every attempt made by ellisoneducation.co.uk Consumer Service to fulfill your order to your satisfaction. Email updates will be sent as we process your items.
          %p== For all deliveries outside of Europe, please #{link_to "contact us", "/contact"}.
        - if is_er?
          %p Updates to stock status on ellison.com are done routinely. Product availability shown on the Web site is not guaranteed (especially on clearance and promotional items) until your order is processed by Ellison and your credit card is charged. Orders are processed on a first come, first served basis with every attempt made by Ellison Consumer Service to fulfill your order to your satisfaction. Email updates will be sent as we process your items.
    - else
      .right.minilink= link_to "Edit #{cart_name}", cart_path       
.clear